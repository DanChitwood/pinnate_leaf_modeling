# pinnate_leaf_modeling
Modeling leaflet and lobe shape within pinnate leaves
![pinnate_leaves_figure](https://github.com/DanChitwood/pinnate_leaf_modeling/assets/3772583/2ccb1af5-e429-4078-a266-c6ff08e4299f)

# Motivation
We were motivated to model leaflets and lobes within *Cannabis* leaves, so that leaves with different numbers of leaflets or lobes within a plant can be compared to each other and to discern differences between genotypes rather than the heteroblastic series. We model corresponding pseudo-landmarks for each leaflet as angle-radius coordinates relative to the petiolar junction and model angle or radius as a function of leaflet to create continuous polynomial models that bypass the problems associated with variable numbers of leaflets between leaves. 

It has been proposed that pinnate, palmate, and peltate compound leaves share a common developmental origin based on the extent of adaxial-abaxial juxtaposition that gives rises to blade (and leaflet or lobe) outgrowth along the petiole ([Kim *et al.*, *Nature* 2003](https://www.nature.com/articles/nature01820)). Others have proposed methods to automatically isolate individual leaflets ([Failmezger *et al.*, *Plant Methods* 2018](https://doi.org/10.1186/s13007-018-0290-y) or to model developmental trajectories, such as heteroblastic series ([Biot *et al.*, *Development* 2016](https://doi.org/10.1242/dev.134619). Here, we seek to build on these works and conceptually extend our framework of continuously modeling leaflets within a palmate leaf to pinnate leaves.

# Methods
Leaflets (*Caradmine flexuosa*) and lobes (*Quercus macrocarpa*) were demarcated with two landmarks at the base and one at the tip. Along each side of a leaflet or lobe, 100 equidistanly pseudo-landmarks were placed. Each leaflet or lobe was rotated so that it was parallel to the rachis of the leaf. For each pseudo-landmark, 2nd degree polynomial models of $x$ and $y$ values were fit using the python `scipy.optimize.curve_fit` function. Five modeled leaflets or lobes were reconstructed, showing that comparable numbers of leaflets or lobes can be modeled allowing for morphometric approaches to be extended to compound leaves with differing numbers of laminar units, and feasibly across palmately and pinnately compound leaves.

# Figure caption
**Intra-leaf modeling of leaflets and lobes extended to pinnate leaves:** Leaves from **A)** *Cardamine flexuosa* and **B)** *Quercus marcocarpa*. The rachis to which leaflets and lobes are oriented is indicated on each leaf. Leaflets and lobes are defined by 100 equidistant pseudo-lanmdarks on each side, each defined by three lanmdarks, two at the base and one at the tip. Large points are placed every 20 pseudo-landmarks to emphsaize that leaflet outlines are defined by points. Leaves are continuously colored using a rainbow palette around the rachis of the leaf. The transformed leaflets and lobes have been oriented parallel to the rachis, as defined by the landmarks at their base. The modeled leaflets and lobes are created from second degree polynomial models for each $x$ and $y$ coordinate value for each pseudo-landmark as a funciton of leaflet or lobe number. From these models, an equivalent number of modeled leaflets or lobes can be reconstructed (in this case, five), permitting morphometric analysis.
